{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information",
      "Lean.Hbt.Infrastructure.Security": "Debug"
    }
  },
  "AllowedHosts": "*",
  "Server": {
    "UseHttps": true,
    "HttpPort": 5249,
    "HttpsPort": 7249,
    "EnableSwagger": true,
    "EnableCors": true
  },
  "Cors": {
    "EnableAll": true,
    "PolicyName": "HbtPolicy",
    "Origins": [
      "http://localhost:5349",
      "https://localhost:7349",
      "http://localhost:5249",
      "https://localhost:7249"
    ],
    "Methods": [
      "GET",
      "POST",
      "PUT",
      "DELETE",
      "OPTIONS"
    ],
    "Headers": [
      "*"
    ],
    "AllowCredentials": true
  },
  "Cache": {
    "Provider": "Memory",
    "DefaultExpirationMinutes": 30,
    "EnableSlidingExpiration": true,
    "EnableMultiLevelCache": false,
    "Memory": {
      "CompactionThreshold": 1048576,
      "ExpirationScanFrequency": 60,
      "SizeLimit": 104857600
    },
    "Redis": {
      "Enabled": false,
      "ConnectionString": "",
      "InstanceName": "Lean.Hbt",
      "DefaultDatabase": 0,
      "ConnectTimeout": 5000,
      "SyncTimeout": 5000,
      "AllowAdmin": true,
      "Ssl": false,
      "Password": "",
      "EnableCompression": true,
      "CompressionThreshold": 1024
    }
  },
  "ConnectionStrings": {
    "IdentityDB": "Server=fs03;Database=Hbt_Dev_Entra;User Id=sa;Password=Tac26901333.;MultipleActiveResultSets=true;TrustServerCertificate=true",
    "BusinessDB": "Server=fs03;Database=Hbt_Dev_Biz;User Id=sa;Password=Tac26901333.;MultipleActiveResultSets=true;TrustServerCertificate=true",
    "WorkflowDB": "Server=fs03;Database=Hbt_Dev_Flow;User Id=sa;Password=Tac26901333.;MultipleActiveResultSets=true;TrustServerCertificate=true",
    "GeneratorDB": "Server=fs03;Database=Hbt_Dev_Gen;User Id=sa;Password=Tac26901333.;MultipleActiveResultSets=true;TrustServerCertificate=true"
  },
  "Database": {
    "DbType": 1,
    "IsAutoCloseConnection": true,
    "EnableDiffLogEvent": true,
    "MaxPoolSize": 100,
    "MinPoolSize": 5,
    "ConnectionTimeout": 30,
    "CommandTimeout": 30,
    "Init": {
      "InitDatabase": true,
      "InitSeedData": true
    }
  },
  "Comment": {
    "_comment": "评论配置",
    "MaxCommentLength": 1000,
    "MinCommentLength": 1,
    "EnableSensitiveWordFilter": true,
    "EnableLengthLimit": true,
    "EnableCommentAudit": true,
    "DefaultAuditStatus": 0,
    "AllowAnonymousComment": false,
    "CommentRateLimit": 30,
    "EnableIpLimit": true,
    "DailyIpCommentLimit": 50,
    "EnableUserCommentLimit": true,
    "DailyUserCommentLimit": 20,
    "EnableDuplicateCheck": true,
    "DuplicateCheckHours": 24
  },
  "Excel": {
    "Author": "Lean365",
    "Title": "黑冰台",
    "Subject": "导入导出文档",
    "Category": "业务数据",
    "Keywords": "Lean.Hbt,Excel,Export",
    "Comments": "由黑冰台系统导出",
    "Status": "已完成",
    "Application": "Lean.Hbt",
    "Company": "Lean365",
    "Manager": "Hbt365"
  },
  "Security": {
    "LoginPolicy": {
      "MaxFailedAttempts": 5,
      "LockoutMinutes": 30,
      "EnableLoginRestriction": true,
      "CaptchaRequiredAttempts": 3,
      "CaptchaRequiredMinutes": 5,
      "RepeatLoginMinutes": 5
    },
    "SingleSignOn": {
      "Enabled": false,
      "MaxDevices": 3,
      "KickoutOldSession": false,
      "NotifyKickout": false,
      "KickoutMessage": "您的账号已在其他地方登录",
      "MaxConcurrentSessions": 3,
      "MaxConnectionsPerUser": 3
    },
    "PasswordPolicy": {
      "MinLength": 6,
      "MaxLength": 20,
      "RequireDigit": true,
      "RequireLowercase": true,
      "RequireUppercase": false,
      "RequireSpecialChar": false,
      "PasswordExpirationDays": 90,
      "DefaultPassword": "123456",
      "DefaultErrorLimit": 3,
      "DefaultLockTime": 30
    },
    "Session": {
      "AllowMultipleDevices": true,
      "MaxConcurrentSessions": 3,
      "TimeoutMinutes": 30,
      "EnableSlidingExpiration": true,
      "EnableAbsoluteExpiration": true,
      "AbsoluteExpirationHours": 24,
      "SessionExpiryMinutes": 60
    }
  },
  "SmsAuth": {
    "Enabled": false,
    "Provider": "Aliyun",
    "AccessKeyId": "your-sms-access-key-id",
    "AccessKeySecret": "your-sms-access-key-secret",
    "SignName": "黑冰台",
    "TemplateCode": "SMS_123456789",
    "ExpirationMinutes": 5,
    "MaxSendCountPerHour": 10,
    "EnableCaptcha": true,
    "CaptchaRequiredAttempts": 3,
    "EnableFrequencyLimit": true,
    "EnableIpLimit": true,
    "MaxSendCountPerIpPerHour": 20
  },
  "QrCodeAuth": {
    "Enabled": false,
    "ExpirationMinutes": 5,
    "PixelsPerModule": 20,
    "EccLevel": "M",
    "BaseUrl": "https://localhost:7249/qr",
    "EnableWeChatLogin": true,
    "EnableAlipayLogin": true,
    "EnableDeviceTracking": true,
    "MaxQrCodePerUser": 5,
    "AutoCleanupEnabled": true,
    "CleanupIntervalMinutes": 10,
    "WeChat": {
      "AppId": "your-wechat-app-id",
      "RedirectUri": "https://localhost:7249/qr/wechat/callback",
      "Scope": "snsapi_login"
    },
    "Alipay": {
      "AppId": "your-alipay-app-id",
      "RedirectUri": "https://localhost:7249/qr/alipay/callback",
      "Scope": "auth_user"
    }
  },
  "OAuth": {
    "Enabled": false,
    "DefaultRedirectUri": "https://localhost:7249/oauth/callback",
    "SessionTimeoutMinutes": 30,
    "Google": {
      "Enabled": true,
      "ClientId": "your-google-client-id",
      "ClientSecret": "your-google-client-secret",
      "RedirectUri": "https://localhost:7249/oauth/google/callback",
      "Scope": "openid email profile",
      "AuthorizationUrl": "https://accounts.google.com/o/oauth2/v2/auth",
      "TokenUrl": "https://oauth2.googleapis.com/token",
      "UserInfoUrl": "https://www.googleapis.com/oauth2/v2/userinfo"
    },
    "Apple": {
      "Enabled": true,
      "ClientId": "your-apple-client-id",
      "ClientSecret": "your-apple-client-secret",
      "RedirectUri": "https://localhost:7249/oauth/apple/callback",
      "Scope": "name email",
      "AuthorizationUrl": "https://appleid.apple.com/auth/authorize",
      "TokenUrl": "https://appleid.apple.com/auth/token",
      "UserInfoUrl": "https://appleid.apple.com/auth/userinfo",
      "TeamId": "your-apple-team-id",
      "KeyId": "your-apple-key-id",
      "PrivateKey": "your-apple-private-key"
    },
    "Amazon": {
      "Enabled": true,
      "ClientId": "your-amazon-client-id",
      "ClientSecret": "your-amazon-client-secret",
      "RedirectUri": "https://localhost:7249/oauth/amazon/callback",
      "Scope": "profile",
      "AuthorizationUrl": "https://www.amazon.com/ap/oa",
      "TokenUrl": "https://api.amazon.com/auth/o2/token",
      "UserInfoUrl": "https://api.amazon.com/user/profile"
    },    
    "Facebook": {
      "Enabled": true,
      "AppId": "your-facebook-app-id",
      "AppSecret": "your-facebook-app-secret",
      "RedirectUri": "https://localhost:7249/oauth/facebook/callback",
      "Scope": "email,public_profile",
      "AuthorizationUrl": "https://www.facebook.com/v12.0/dialog/oauth",
      "TokenUrl": "https://graph.facebook.com/v12.0/oauth/access_token",
      "UserInfoUrl": "https://graph.facebook.com/me"
    },
    "Twitter": {
      "Enabled": true,
      "ApiKey": "your-twitter-api-key",
      "ApiKeySecret": "your-twitter-api-secret",
      "RedirectUri": "https://localhost:7249/oauth/twitter/callback",
      "Scope": "tweet.read users.read offline.access",
      "AuthorizationUrl": "https://twitter.com/i/oauth2/authorize",
      "TokenUrl": "https://api.twitter.com/2/oauth2/token",
      "UserInfoUrl": "https://api.twitter.com/2/users/me"
    },
    "LinkedIn": {
      "Enabled": true,
      "ClientId": "your-linkedin-client-id",
      "ClientSecret": "your-linkedin-client-secret",
      "RedirectUri": "https://localhost:7249/oauth/linkedin/callback",
      "Scope": "r_liteprofile r_emailaddress",
      "AuthorizationUrl": "https://www.linkedin.com/oauth/v2/authorization",
      "TokenUrl": "https://www.linkedin.com/oauth/v2/accessToken",
      "UserInfoUrl": "https://api.linkedin.com/v2/me"
    },
    "QQ": {
      "Enabled": true,
      "AppId": "your-qq-app-id",
      "AppKey": "your-qq-app-key",
      "RedirectUri": "https://localhost:7249/oauth/qq/callback",
      "Scope": "get_user_info",
      "AuthorizationUrl": "https://graph.qq.com/oauth2.0/authorize",
      "TokenUrl": "https://graph.qq.com/oauth2.0/token",
      "UserInfoUrl": "https://graph.qq.com/user/get_user_info"
    },

    "Microsoft": {
      "Enabled": true,
      "ClientId": "your-microsoft-client-id",
      "ClientSecret": "your-microsoft-client-secret",
      "RedirectUri": "https://localhost:7249/oauth/microsoft/callback",
      "Scope": "openid email profile",
      "AuthorizationUrl": "https://login.microsoftonline.com/common/oauth2/v2.0/authorize",
      "TokenUrl": "https://login.microsoftonline.com/common/oauth2/v2.0/token",
      "UserInfoUrl": "https://graph.microsoft.com/v1.0/me"
    },
    "GitHub": {
      "Enabled": true,
      "ClientId": "your-github-client-id",
      "ClientSecret": "your-github-client-secret",
      "RedirectUri": "https://localhost:7249/oauth/github/callback",
      "Scope": "read:user,user:email",
      "AuthorizationUrl": "https://github.com/login/oauth/authorize",
      "TokenUrl": "https://github.com/login/oauth/access_token",
      "UserInfoUrl": "https://api.github.com/user"
    },
    "DingTalk": {
      "Enabled": true,
      "AppId": "your-dingtalk-app-id",
      "AppSecret": "your-dingtalk-app-secret",
      "RedirectUri": "https://localhost:7249/oauth/dingtalk/callback",
      "Scope": "openid",
      "AuthorizationUrl": "https://oapi.dingtalk.com/connect/oauth2/sns_authorize",
      "TokenUrl": "https://oapi.dingtalk.com/gettoken",
      "UserInfoUrl": "https://oapi.dingtalk.com/user/getuserinfo"
    },

    "Weibo": {
      "Enabled": true,
      "AppKey": "your-weibo-app-key",
      "AppSecret": "your-weibo-app-secret",
      "RedirectUri": "https://localhost:7249/oauth/weibo/callback",
      "Scope": "all",
      "AuthorizationUrl": "https://api.weibo.com/oauth2/authorize",
      "TokenUrl": "https://api.weibo.com/oauth2/access_token",
      "UserInfoUrl": "https://api.weibo.com/2/users/show.json"
    }
  },
  "Jwt": {
    "SecretKey": "vCVQF1fJIz1yt41bQx2kOqWWiHoT03UgLX2HTogAxR7zGqDNbpeMGT",
    "Issuer": "Lean.Hbt",
    "Audience": "Lean.Hbt.WebApi",
    "ExpirationMinutes": 30,
    "RefreshTokenExpirationDays": 7
  },
  "LogCleanup": {
    "Enabled": true,
    "Interval": 24,
    "AuditLogRetentionDays": 90,
    "OperLogRetentionDays": 90,
    "LoginLogRetentionDays": 90,
    "ExceptionLogRetentionDays": 90,
    "DbDiffLogRetentionDays": 90,
    "BatchSize": 1000
  },
  "LogArchive": {
    "Enabled": true,
    "ArchivePeriodMonths": 1,
    "ArchivePath": "Logs/Archive",
    "FileNameFormat": "logs_{0:yyyy_MM}.zip",
    "BatchSize": 1000,
    "CronExpression": "0 0 1 1 * ?"
  },
  "Captcha": {
    "Type": "Slider",
    "Slider": {
      "Width": 400,
      "Height": 100,
      "SliderWidth": 48,
      "Tolerance": 8,
      "ExpirationMinutes": 5,
      "BackgroundImages": {
        "RedownloadOnStartup": false,
        "MinCount": 5,
        "DownloadUrl": "https://picsum.photos/{width}/{height}",
        "StoragePath": "slide/background",
        "FileExtension": ".jpg",
        "Template": {
          "UseTemplate": true,
          "TemplatePath": "slide/template",
          "GroupCount": 5
        }
      }
    },
    "Behavior": {
      "ScoreThreshold": 0.5,
      "DataExpirationMinutes": 30,
      "EnableMachineLearning": false
    }
  },
  "Monitoring": {
    "Enabled": true,
    "RefreshInterval": 5,
    "ProcessFilter": {
      "ExcludeSystemProcesses": true,
      "MinMemoryUsageMB": 50,
      "MaxProcessCount": 50
    },
    "NetworkFilter": {
      "ExcludeLoopback": true,
      "ExcludeDisabled": true
    },
    "ServiceFilter": {
      "ExcludeDisabled": true,
      "ExcludeSystemServices": false
    },
    "Alerts": {
      "CpuThreshold": 90,
      "MemoryThreshold": 90,
      "DiskThreshold": 90
    }
  },
  "HbtMail": {
    "Host": "smtp.qq.com",
    "Port": 587,
    "UseSsl": true,
    "FromEmail": "your-email@qq.com",
    "FromName": "Lean.Hbt系统通知",
    "UserName": "your-email@qq.com",
    "Password": "your-password"
  },
  "HbtQuartz": {
    "Enabled": true,
    "InstanceName": "HbtQuartzScheduler",
    "TablePrefix": "QRTZ_",
    "SerializerType": "json",
    "UseDatabase": true,
    "Cluster": {
      "Enabled": false,
      "CheckinInterval": 15000,
      "CheckinMisfireThreshold": 15000
    },
    "ThreadPool": {
      "MaxConcurrency": 10,
      "ThreadPriority": 5
    }
  },
  "SystemRestart": {
    "ClearUserSessions": true,
    "ClearCache": true,
    "ClearRealTimeConnections": true,
    "ClearSystemStatus": true,
    "ClearSecurityInfo": true,
    "ClearTempData": true,
    "ClearPerformanceData": true,
    "ClearDistributedState": true,
    "ClearTokenBlacklist": false
  },
  "SignalR": {
    "EnableDetailedErrors": true,
    "ClientTimeoutInterval": 60,
    "KeepAliveInterval": 15,
    "HandshakeTimeout": 15,
    "MaximumReceiveMessageSize": 32768,
    "StreamBufferCapacity": 10,
    "EnableMessagePack": true,
    "Transport": {
      "WebSockets": {
        "CloseTimeout": 5,
        "SubProtocol": "json"
      },
      "ServerSentEvents": {
        "ClientTimeoutInterval": 60
      },
      "LongPolling": {
        "PollTimeout": 90
      }
    },
    "Authentication": {
      "RequireAuthentication": true,
      "TokenValidation": {
        "ValidateIssuer": true,
        "ValidateAudience": true,
        "ValidateLifetime": true,
        "ValidateIssuerSigningKey": true
      }
    },
    "UserManagement": {
      "MaxDevicesPerUser": 3,
      "AllowMultipleConnections": true,
      "KickoutOldSession": true,
      "NotifyKickout": true
    },
    "DeviceManagement": {
      "EnableDeviceTracking": true,
      "MaxDevicesPerUser": 3,
      "DeviceTimeoutMinutes": 30
    }
  },
  "SignalRCache": {
    "DefaultCacheMinutes": 30,
    "MaxUsers": 10000,
    "MaxCacheSizeMB": 100,
    "CleanupIntervalMinutes": 5,
    "EnableSizeLimit": true,
    "EnableUserLimit": true,
    "EnableConnectionLimit": true,
    "EnableAutoCleanup": true
  },
  "Workflow": {
    "MaxExecutionDays": 3,
    "AutoExecution": {
      "Enabled": true,
      "IntervalMinutes": 2
    },
    "TimeoutReminder": {
      "Enabled": true,
      "IntervalMinutes": 5,
      "ReminderHours": 24
    },
    "Cleanup": {
      "Enabled": true,
      "RetentionDays": 90,
      "CronExpression": "0 0 2 * * ?"
    }
  },
  "FileUpload": {
    "Import": {
      "MultipartBodyLengthLimit": 10485760,
      "MultipartHeadersLengthLimit": 32768,
      "MultipartBoundaryLengthLimit": 128,
      "ValueLengthLimit": 10485760,
      "KeyLengthLimit": 1024,
      "MaxFileSize": 10485760,
      "AllowedExtensions": [
        ".xlsx",
        ".txt"
      ]
    },
    "Normal": {
      "MultipartBodyLengthLimit": 20971520,
      "MultipartHeadersLengthLimit": 32768,
      "MultipartBoundaryLengthLimit": 128,
      "ValueLengthLimit": 20971520,
      "KeyLengthLimit": 1024,
      "MaxFileSize": 20971520,
      "AllowedExtensions": [
        ".jpg",
        ".jpeg",
        ".png",
        ".gif",
        ".pdf",
        ".docx",
        ".xlsx",
        ".pptx",
        ".txt",
        ".mp4",
        ".avi",
        ".mov",
        ".wmv",
        ".flv",
        ".mkv"
      ]
    }
  }
}